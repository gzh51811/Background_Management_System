"use strict";function _asyncToGenerator(e){return function(){var s=e.apply(this,arguments);return new Promise(function(i,o){return function t(e,n){try{var a=s[e](n),r=a.value}catch(e){return void o(e)}if(!a.done)return Promise.resolve(r).then(function(e){t("next",e)},function(e){t("throw",e)});i(r)}("next")})}}jQuery(function(i){var r=this,o=i(".username"),s=i(".nickname"),l=i(".userpw"),u=i(".tel"),c=i(".gander"),m=i(".shengri"),d=i(".zhiye"),f=i(".city"),h=i(".youxiang"),v=i(".beizhu"),y=i(".btn"),p=i(".tips1"),g=location.search.slice(1).split("=")[1];layui.use("element",function(){layui.element}),layui.use("laydate",function(){layui.laydate.render({elem:"#test1"})});var k=localStorage.token||sessionStorage.token||"";function b(e){o.val(e.username).attr("data-name",""+e.username),s.val(e.nickname),l.val(e.upw),m.val(e.birthday),d.val(e.job),f.val(e.city),h.val(e.email),v.val(e.markdown),u.val(e.tel),c.find("select option:contains("+e.gander+")").prop("selected","selected"),layui.use("form",function(){layui.form})}function x(e){var t,n,a,r={username:o.val(),nickname:s.val(),upw:l.val(),birthday:m.val(),job:d.val(),city:f.val(),email:h.val(),markdown:v.val(),tel:u.val(),gander:c.find(".layui-anim dd").filter(".layui-this").html()};"insert"===e?j(r):"update"===e&&(t=r,n={_id:g},a=Object.assign({},t,n),i.post("/api/userList/update",a,function(e){e.code?1==e.code?location.href="userList.html":2==e.code&&p.html(e.msg).css("color","green"):p.html(e.msg).css("color","red")},"json"))}function j(e){var t={jurisdiction:"common",photoUrl:"/images/touxiang.jpg",reqTime:Date.now()},n=Object.assign({},e,t);i.post("/api/userList/add",n,function(e){e.code?1==e.code&&(location.href="userList.html"):p.html(e.msg).css("color","red")},"json")}k?_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i(".userHead"),n=i(".uname"),e.next=4,verifyToken(k);case 4:if(a=e.sent,t.attr("src",a.ress[0].photoUrl),n.html(a.ress[0].nickname),"admin"!=a.ress[0].jurisdiction){e.next=21;break}if(g)return e.next=11,userAjax({_id:g});e.next=16;break;case 11:b(e.sent.data[0]),y.click(function(){var e=i(".tipsGander"),t=c.find(".layui-anim dd").filter(".layui-this").html();if("男"!=t&&"女"!=t)return e.html("请选择性别").css("color","red"),!1;e.html("");var n=o.val();if(n!=o.attr("data-name"))return j({username:n}),!1;p.html(""),x("update")}),e.next=18;break;case 16:layui.use("form",function(){layui.form}),y.click(function(){var e=i(".tipsGander"),t=c.find(".layui-anim dd").filter(".layui-this").html();if("男"!=t&&"女"!=t)return e.html("请选择性别").css("color","red"),!1;e.html(""),x("insert")});case 18:quit(),e.next=23;break;case 21:alert("您的用户权限不足"),location.href="../login.html";case 23:case"end":return e.stop()}},e,r)}))():location.href="../login.html",o.change(function(){var e=o.val();e==o.attr("data-name")?p.html(""):j({username:e})})});