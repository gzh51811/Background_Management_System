"use strict";function _asyncToGenerator(t){return function(){var r=t.apply(this,arguments);return new Promise(function(s,c){return function n(t,e){try{var a=r[t](e),i=a.value}catch(t){return void c(t)}if(!a.done)return Promise.resolve(i).then(function(t){n("next",t)},function(t){n("throw",t)});s(i)}("next")})}}jQuery(function(c){var n=this;layui.use("element",function(){layui.element});var r=c("tbody"),o=localStorage.token||sessionStorage.token||"";function l(e){var a=[];c.each(e,function(t,n){var e=c(n).closest("tr").find(".td3").html();a.push(e)});var t={usernames:a.join()};c.post("/api/userList/delAll",t,function(t){if(t.code){e.closest("tr").remove();var n=c("tbody tr .td2");c.each(n,function(t,n){c(n).html(t+1)})}},"json")}function d(){var t=c(".allBtn "),n=c("tbody .td1 i"),e=c(".addUserBtn"),a=c(".allDelBtn"),i=c(".delUser"),s=c(".changeMsg");n.click(function(){c(this).toggleClass("layui-icon-ok check"),n.filter(".check").length==n.length?t.addClass("layui-icon-ok"):t.removeClass("layui-icon-ok")}),t.click(function(){c(this).toggleClass("layui-icon-ok"),t.hasClass("layui-icon-ok")?n.addClass("layui-icon-ok check"):n.removeClass("layui-icon-ok check")}),e.click(function(){location.href="/html/addUser.html"}),a.click(function(){l(n.filter(".check"))}),i.click(function(){l(c(this))}),s.click(function(){var t=c(this).closest("tr").find(".td2").attr("data-id");location.href="addUser.html?id="+t})}o?_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,a,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=c(".userHead"),a=c(".uname"),t.next=4,verifyToken(o);case 4:if(i=t.sent,e.attr("src",i.ress[0].photoUrl),a.html(i.ress[0].nickname),"admin"==i.ress[0].jurisdiction)return t.next=10,userAjax({jurisdiction:"common"});t.next=15;break;case 10:s=t.sent,n=s.data,c.each(n,function(t,n){var e=time(1*n.reqTime),a=e.year+"-"+e.month+"-"+e.day,i='\n            <tr>\n                <td class="td1"><i class="layui-icon"></i></td>\n                <td class="td2" data-id="'+n._id+'">'+(t+1)+'</td>\n                <td class="td3">'+n.username+'</td>\n                <td class="td4">'+n.nickname+'</td>\n                <td class="td5">'+n.gander+'</td>\n                <td class="td6">'+n.city+'</td>\n                <td class="td7">'+n.job+'</td>\n                <td class="td8">'+n.birthday+'</td>\n                <td class="td9">'+n.tel+'</td>\n                <td class="td10">'+a+'</td>\n                <td class="td11">\n                    <div class="layui-btn-group">\n                        <button class="layui-btn layui-btn-sm changeMsg">\n                            <i class="layui-icon"></i>\n                        </button>\n                    </div>\n                    <div class="layui-btn-group">\n                        <button class="layui-btn layui-btn-primary layui-btn-sm delUser">\n                            <i class="layui-icon">&#xe640;</i>\n                        </button>\n                    </div>\n                </td>\n            </tr>\n            ';r.append(i)}),d(),t.next=17;break;case 15:alert("您的用户权限不足"),location.href="../login.html";case 17:quit();case 18:case"end":return t.stop()}var n},t,n)}))():location.href="../login.html"});