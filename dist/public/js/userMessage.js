"use strict";function _asyncToGenerator(e){return function(){var s=e.apply(this,arguments);return new Promise(function(i,o){return function n(e,t){try{var r=s[e](t),a=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});i(a)}("next")})}}jQuery(function(i){var t=this;layui.use("element",function(){layui.element}),layui.use("laydate",function(){layui.laydate.render({elem:"#test1"})});var r=i("#img"),a=i("#goods");a.on("change",function(){var e=this.files[0];if(window.FileReader){var n=new FileReader;n.onloadend=function(e){r.attr("src",e.target.result)},e&&n.readAsDataURL(e)}});var o=i(".nickname"),n=i(".uname"),s=i(".confirmPw"),u=i(".userpw"),c=i(".tel"),l=i(".gander"),f=i(".shengri"),v=i(".zhiye"),d=i(".city"),m=i(".youxiang"),y=i(".beizhu"),p=i(".btn"),h=i(".userHead"),w=localStorage.token||sessionStorage.token||"";function g(e){h.attr("src",""+e.photoUrl),r.attr("src",""+e.photoUrl),n.html(e.nickname),o.val(e.nickname),u.val(e.upw),s.val(e.upw),f.val(e.birthday),v.val(e.job),d.val(e.city),m.val(e.email),y.val(e.markdown),c.val(e.tel),l.find("select option:contains("+e.gander+")").prop("selected","selected"),layui.use("form",function(){layui.form})}function k(a){return new Promise(function(n,e){var t={_id:_id,nickname:o.val(),upw:u.val(),birthday:f.val(),job:v.val(),city:d.val(),email:m.val(),markdown:y.val(),tel:c.val(),gander:l.find(".layui-anim dd").filter(".layui-this").html()},r=Object.assign({},t,a);i.post("/api/userList/update",r,function(e){n(e)},"json")})}w?_asyncToGenerator(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,verifyToken(w);case 2:n=e.sent,_id=n.ress[0]._id,g(n.ress[0]),quit(),p.click(_asyncToGenerator(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a[0].value)return e.next=4,new Promise(function(n,e){var t=new FormData;t.set("user",a[0].files[0]),i.ajax({url:"/api/userList/upload",type:"post",data:t,contentType:!1,processData:!1,success:function(e){n(e)},error:function(e){}}),a.val=null});e.next=13;break;case 4:return n=e.sent,e.next=7,k({photoUrl:"../"+n.file.filename});case 7:return e.next=9,verifyToken(w);case 9:g(e.sent.ress[0]),e.next=19;break;case 13:return e.next=15,k();case 15:return e.next=17,verifyToken(w);case 17:g(e.sent.ress[0]);case 19:case"end":return e.stop()}},e,this)})));case 7:case"end":return e.stop()}},e,t)}))():location.href="login.html"});